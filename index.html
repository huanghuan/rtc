<html>
<head>
<meta name='viewport' content='width=device-width,initial-scale=1,user-scalable=0'>
<meta charset='UTF-8'>
<script src='https://simplewebrtc.com/latest-v2.js'></script>
<script src='https://cdn.bootcss.com/zepto/1.2.0/zepto.min.js'></script>
<style>
aside {
	position: fixed;
	right: 16px;
	top: 16px;
}
body {
	margin: 0;
	background: #07c url(bg.svg) no-repeat center;
	background-size: contain;
}
video {
	display: block;
	width: 128px;
	height: auto;
}
.max {
	position: fixed;
	left: 0;
	top: 0;
	width: 100%;
	height: 100%;
	object-fit: cover;
	z-index: -100;
}
#shareScreen {
	position: fixed;
	left: 16px;
	top: 16px;
	opacity: 0.6;
}
#conversation {
	position: fixed;
	left: -25%;
	top: 0;
	bottom: 0;
	width: 25%;
	opacity: 0;
	background: #fff;
	border-right: 4px solid #eee;
	padding: 8px;
	transition: all 0.5s;
}
#conversation.show {
	left: 0;
	opacity: 1;
}
#conversation footer {
	position: absolute;
	left: 0;
	right: 0;
	bottom: 0;
	background: #eee;
	-border-top: 1px solid #ddd;
	padding: 4px;
	display: flex;
}
footer img {
	flex: 0 0;
	margin: 1px 0 1px 5px;
	vertical-align: middle;
}
input {
	border: 0;
	flex: 1 1;
	padding: 8px;
}
</style>
</head>
<body title='按F11键切换全屏'>
<aside>
<video id='localVideo'></video>
</aside>
<div id='conversation'><footer><input>
<img src='text.png'>
<img src='file.png'>
<img src='cancel.png'></footer></div>
<img id='shareScreen' src='screens.png' title='共享屏幕'>
<script>
var aside = document.getElementsByTagName('aside')[0];
var rtc = new SimpleWebRTC({
	autoRemoveVideos: false,
	autoRequestMedia: true,
	localVideoEl: 'localVideo'
});
$('#shareScreen').click(function() {
	try {
		rtc.shareScreen();
	} catch (err) {
		if (confirm('请先下载并安装浏览器插件'))
			location = '屏幕共享.zip';
	}
	$('#conversation').toggleClass('show');
});
rtc.on('readyToCall', function() {
	rtc.joinRoom('79');
}).on('videoAdded', function(video) {
	aside.appendChild(video);
	$(video).click();
}).on('videoRemoved', function(video) {
	aside.removeChild(video);
}).on('localScreenAdded', function(video) {
	$('#shareScreen').hide();
	aside.appendChild(video);
}).on('localScreenStopped', function(video) {
	$('#shareScreen').show();
});
$(document).on('click', 'video', function(e) {
	$('.max').removeClass('max');
	$(e.target).addClass('max');
});
</script>
</body>
</html>
