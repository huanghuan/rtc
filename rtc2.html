<html>
<head>
<meta charset='UTF-8'>
<script src="https://simplewebrtc.com/latest-v2.js"></script>
<script src='https://cdn.bootcss.com/zepto/1.2.0/zepto.min.js'></script>
<style>
body {
	background: #333;
	margin: 0;
}
button {
	display: none;
	width: 80px;
}
aside {
	position: fixed;
	right: 0;
	top: 0;
	width: 160px;
	margin: 20px;
}
aside video {
	width: 160px;
	height: auto;
	object-fit: cover;
}
#remote>video:last-child {
	position: fixed;
	left: 0;
	top: 0;
	width: 100%;
	height: 100%;
	z-index: -100;
	object-fit: cover;
}
</style>
</head>
<body>
<aside>
<video id='local'></video>
<button id='joinRoom'>加入会议</button><button id='leaveRoom'>离开会议</button><button id='shareScreen'>分享屏幕</button><button id='stopScreenShare'>停止分享</button>
<div id='localScreen'></div>
<div id='remote'></div>
</aside>
<script>
var handlers = {
	joinRoom: function() {
		rtc.joinRoom('test');
		$('#joinRoom').hide();
		$('#leaveRoom').show();
		$('#shareScreen').show();
	},
	leaveRoom: function() {
		rtc.leaveRoom();
		$('button').hide();
		$('#joinRoom').show();
	},
	shareScreen: function() {
		rtc.shareScreen();
	},
	stopScreenShare: function() {
		if (rtc.getLocalScreen()) rtc.stopScreenShare();
		$('#shareScreen').show();
		$('#stopScreenShare').hide();
	}
};
var rtc = new SimpleWebRTC({
	localVideoEl: 'local',
	remoteVideosEl: 'remote',
	autoRequestMedia: true
});
rtc.on('readyToCall', function() {
	$('#joinRoom').show();
}).on('localScreenAdded', function(video) {
	$('#localScreen').append($(video));
	$('#shareScreen').hide();
	$('#stopScreenShare').show();
}).on('localScreenRemoved', function(video) {
	$(video).remove();
	$('#shareScreen').show();
	$('#stopScreenShare').hide();
});
$(document).on('click', 'button', function(e) {
	handlers[e.target.id]();
});
</script>
</body>
</html>
